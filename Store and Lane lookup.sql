/* 4/14/2017 */


-- Punctuation to remove - anything not alphabet or numbers
DECLARE @BADCHARS VARCHAR(MAX) --= '%[^a-z0-9]%'
select @BADCHARS = '%[^a-z0-9]%'
select @BADCHARS

/* get store / lane number from list of IRs */

SELECT IncidentDimvw.Id 
	, Region
	, Location
	, case when (patindex('%[^0-9][0-9][0-9][0-9][0-9][0-9][^0-9]%',' '+title)>0) then substring(title,patindex('%[^0-9][0-9][0-9][0-9][0-9][0-9][^0-9]%',title)+1,5) else null end as StoreNumber
	, case 
		when ( (CHARINDEX ( 'ALL LANES' ,UPPER(' ' +title) ) > 0) ) then 'ALL LANES'
		when (CHARINDEX ( 'LANE' ,UPPER(' ' + title) ) > 0) 
			then REPLACE(REPLACE(LTRIM(RTRIM(substring(title,CHARINDEX ( 'LANE' ,UPPER(' ' + title) ) + 4,4))),',',''),'-','')
		else null end [Lane Affected]
	, Title
	, Description
FROM IncidentDimvw
WHERE 
ID IN
(
'IR2588397',
'IR2588305',
'IR2588375',
'IR2590063',
'IR2590838',
'IR2591592',
'IR2591855',
'IR2592009',
'IR2592145',
'IR2592197',
'IR2593199',
'IR2593270',
'IR2593335',
'IR2597855',
'IR2600135',
'IR2600964',
'IR2601139',
'IR2601999',
'IR2602985',
'IR2605173',
'IR2605931',
'IR2606142',
'IR2607495',
'IR2607496',
'IR2607536',
'IR2607494',
'IR2610953',
'IR2612386',
'IR2612462',
'IR2612451',
'IR2613127',
'IR2614539',
'IR2613947',
'IR2615946',
'IR2615817',
'IR2616222',
'IR2615091',
'IR2616905',
'IR2617710',
'IR2617657',
'IR2618525',
'IR2620326',
'IR2621156',
'IR2621614',
'IR2622298',
'IR2622505',
'IR2622599',
'IR2621918',
'IR2623084',
'IR2623237',
'IR2623297',
'IR2623611',
'IR2623673',
'IR2624322',
'IR2624354',
'IR2624414',
'IR2624705',
'IR2625039',
'IR2625213',
'IR2625960',
'IR2626745',
'IR2626840',
'IR2626844',
'IR2627338',
'IR2627007',
'IR2630714',
'IR2630839',
'IR2631781',
'IR2633526',
'IR2633639',
'IR2633764',
'IR2633778',
'IR2633900',
'IR2633713',
'IR2634240',
'IR2634844',
'IR2635709',
'IR2636357',
'IR2637900',
'IR2638614',
'IR2640064',
'IR2641065',
'IR2640471',
'IR2641726',
'IR2641843',
'IR2642378',
'IR2642845',
'IR2644205',
'IR2644097',
'IR2645142',
'IR2645428',
'IR2646039',
'IR2646241',
'IR2646352',
'IR2646417',
'IR2647142',
'IR2647224',
'IR2648473',
'IR2649258',
'IR2649921',
'IR2650006',
'IR2649931',
'IR2650572',
'IR2650904',
'IR2650885',
'IR2650994',
'IR2651154',
'IR2651213',
'IR2651838',
'IR2652410',
'IR2652684',
'IR2654044',
'IR2654755',
'IR2654757',
'IR2654960',
'IR2655014',
'IR2655267',
'IR2655257',
'IR2655324',
'IR2655797',
'IR2655880',
'IR2655870',
'IR2655827',
'IR2656181',
'IR2656300',
'IR2656350',
'IR2656348',
'IR2656351',
'IR2656542',
'IR2656702',
'IR2656783',
'IR2656977',
'IR2657261',
'IR2657336',
'IR2657533',
'IR2658175',
'IR2658403',
'IR2658489',
'IR2658918',
'IR2659133',
'IR2660047',
'IR2660303',
'IR2660939',
'IR2660856',
'IR2661005',
'IR2661213',
'IR2661828',
'IR2663695',
'IR2663696',
'IR2664234',
'IR2664232',
'IR2665320',
'IR2665734',
'IR2666629',
'IR2668634',
'IR2668693',
'IR2668608',
'IR2668865',
'IR2668611',
'IR2669455',
'IR2669928',
'IR2670189',
'IR2670378',
'IR2670185',
'IR2671713',
'IR2671647',
'IR2671460',
'IR2672076',
'IR2672073',
'IR2672099',
'IR2672282',
'IR2672313',
'IR2673023',
'IR2673317',
'IR2674173',
'IR2674066',
'IR2674623',
'IR2675038',
'IR2675399',
'IR2676321',
'IR2676242',
'IR2676736',
'IR2677164',
'IR2677472',
'IR2677360',
'IR2678187',
'IR2678455',
'IR2678346',
'IR2678320',
'IR2679019',
'IR2679021',
'IR2679018',
'IR2679017',
'IR2679022',
'IR2679020',
'IR2679235',
'IR2681217',
'IR2682277',
'IR2682770',
'IR2683230',
'IR2684494',
'IR2684711'
)	

